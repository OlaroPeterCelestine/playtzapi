# Fix 502 Bad Gateway Error

## Problem
Railway is returning `502 Bad Gateway` - the application isn't running.

## Solution: Deploy the Code

The CORS fix is ready but needs to be deployed to Railway.

### Quick Deploy (3 Commands)

```bash
cd /Users/olaro/Documents/GitHub/playtzapi

# 1. Add all changes
git add .

# 2. Commit
git commit -m "Fix CORS configuration and deploy to Railway"

# 3. Push to Railway
git push
```

### After Pushing

1. **Wait 2-5 minutes** for Railway to build and deploy
2. **Check Railway Dashboard:**
   - Go to your service
   - Check "Deployments" tab
   - Wait for status to show "Active"
3. **Check Logs:**
   - Railway Dashboard â†’ Your Service â†’ Logs
   - Look for any errors

### Test After Deployment

```bash
# Test health
curl https://playtzapi-production.up.railway.app/health

# Should return: {"status":"ok"}

# Test login
curl -X POST https://playtzapi-production.up.railway.app/api/v1/auth/login \
  -H "Content-Type: application/json" \
  -H "Origin: http://localhost:3001" \
  -d '{"username":"admin","password":"admin123"}' \
  -c cookies.txt

# Should return: {"success": true, "user": {...}}
```

## Common Issues After Deployment

### Still Getting 502?

1. **Check Railway Logs:**
   - Look for database connection errors
   - Check for missing environment variables
   - Verify build completed successfully

2. **Verify Environment Variables:**
   - `DATABASE_URL` must be set
   - `PORT` is auto-set by Railway
   - Cloudinary vars are optional but recommended

3. **Restart Service:**
   - Railway Dashboard â†’ Settings â†’ Restart

### Database Connection Failed?

- Check `DATABASE_URL` in Railway variables
- Verify database is running
- Check database credentials

### Build Failed?

- Check Railway build logs
- Ensure `go.mod` is up to date
- Verify all dependencies are available

## What Was Fixed

âœ… CORS configuration for `http://localhost:3001`  
âœ… Credentials (cookies) enabled for cross-origin  
âœ… Preflight OPTIONS request handling  
âœ… Proper CORS headers in responses  

## Next Steps

1. **Deploy** (git push)
2. **Wait** for deployment (2-5 min)
3. **Test** the endpoints
4. **Check logs** if still failing

The code is ready - just needs to be deployed! ðŸš€

